<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>HxH Nen System â€“ Mestre</title>

<style>
body{
  margin:0;
  background:#020617;
  color:#e5e7eb;
  font-family:Arial, sans-serif;
}
header{
  background:#020617;
  border-bottom:2px solid #ef4444;
  padding:10px;
  text-align:center;
  font-size:18px;
}
main{
  padding:14px;
  max-width:1000px;
  margin:auto;
}
.secao{
  border-top:1px solid #ef4444;
  margin-top:14px;
  padding-top:14px;
}
button,input,textarea{
  width:100%;
  margin-top:6px;
  padding:6px;
  background:#020617;
  color:#e5e7eb;
  border:1px solid #ef4444;
}
button{
  background:#ef4444;
  color:#020617;
  font-weight:bold;
  cursor:pointer;
}
button:hover{background:#f87171}
textarea{resize:vertical}
.log{
  font-size:13px;
  border-bottom:1px solid #334155;
  padding:4px 0;
}
</style>
</head>

<body>

<header>ğŸ§™ Hunter Ã— Hunter RPG â€” Mestre</header>

<main>

<div class="secao">
  <h3>ğŸ—ºï¸ Mapa do Mundo (VisÃ£o do Mestre)</h3>
  <img 
    src="https://static.wikia.nocookie.net/hunterxhunter/images/6/64/Hunter_%C3%97_Hunter_World_Map.png"
    style="width:100%;border:1px solid #ef4444"
  >
  <p id="localAtualMapa">Local atual: Nenhum</p>
</div>


<div class="secao">
  <h3>ğŸ“ Evento / Local</h3>
  <input id="local" placeholder="Local (ex: Yorknew)">
  <textarea id="descricao" placeholder="DescriÃ§Ã£o do evento"></textarea>
  <button onclick="criarEvento(document.getElementById("localAtualMapa").innerText =
  "Local atual: " + l;
)">Criar Evento</button>
</div>

<div class="secao">
  <h3>ğŸ§‘ Criar Personagem (Jogador)</h3>
  <input id="nomeFicha" placeholder="Nome do personagem">
  <button onclick="criarFicha()">Adicionar</button>
</div>

<div class="secao">
  <h3>ğŸ“œ Logs da Campanha</h3>
  <div id="logs"></div>
</div>

</main>

<!-- 1ï¸âƒ£ Socket.IO -->
<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>

<!-- 2ï¸âƒ£ CÃ³digo do Mestre -->
<script>
const socket = io("https://hxh-nen-system.onrender.com");

let campanha = {
  eventos: [],
  fichas: [],
  logs: []
};

socket.on("connect", () => {
  console.log("Mestre conectado ao servidor");
});

socket.on("sync", data => {
  campanha = data;
  renderLogs();
});

function criarEvento(){
  const l = local.value;
  const d = descricao.value;
  if(!l || !d) return;

  // 1ï¸âƒ£ Registra o evento
  campanha.eventos.push({
    local: l,
    descricao: d
  });

  // 2ï¸âƒ£ Adiciona log da campanha
  campanha.logs.push(`ğŸ“ Evento em ${l}: ${d}`);

  // 3ï¸âƒ£ Atualiza logs na tela do mestre
  renderLogs();

  // 4ï¸âƒ£ Atualiza local exibido no mapa
  document.getElementById("localAtualMapa").innerText =
    "Local atual: " + l;

  // 5ï¸âƒ£ Envia tudo para o servidor (realtime)
  socket.emit("updateCampanha", campanha);

  // 6ï¸âƒ£ Limpa campos
  local.value = "";
  descricao.value = "";
}


function criarFicha(){
  const n = nomeFicha.value;
  if(!n) return;

  campanha.fichas.push({nome:n,exaustao:0,juramentos:[]});
  campanha.logs.push(`ğŸ§‘ Personagem criado: ${n}`);
  renderLogs(); // ğŸ‘ˆ forÃ§a render local
  socket.emit("updateCampanha", campanha);

  nomeFicha.value="";
}


function renderLogs(){
  logs.innerHTML = "";
  campanha.logs.slice(-15).forEach(l=>{
    logs.innerHTML += `<div class="log">${l}</div>`;
  });
}
</script>

</body>
</html>

